<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="utf-8">
<title>Waterbed Rooms</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Drupal 7 Feature to create a backend for a site like http://airbnb.com with minimal features.">
<meta name="author" content="enzo - Eduardo Garcia">

        <meta name="twitter:card" content="summary">
        <meta name="twitter:image" content="http://enzolutions.com/assets/img/spresso-logo.png">
    <meta name="twitter:title" content="Waterbed Rooms">
    <meta name="twitter:description" content="Drupal 7 Feature to create a backend for a site like http://airbnb.com with minimal features.">
    <meta name="twitter:creator" content="@enzolutions">

<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Waterbed Rooms">
<meta property="og:description" content="Drupal 7 Feature to create a backend for a site like http://airbnb.com with minimal features.">
<meta property="og:url" content="http://enzolutions.com/projects/waterbed_rooms/">
<meta property="og:site_name" content="[enzo]lutions">

<link href="http://enzolutions.com/rss.xml" type="application/rss+xml" rel="alternate" title="[enzo]lutions Feed">
<link rel="icon" type="image/x-icon" href="http://enzolutions.com/favicon.ico">
<link rel="apple-touch-icon" href="http://enzolutions.com/assets/img/touch-icon-iphone.png">
<link rel="apple-touch-icon" sizes="76x76" href="http://enzolutions.com/assets/img/touch-icon-ipad.png">
<link rel="apple-touch-icon" sizes="120x120" href="http://enzolutions.com/assets/img/touch-icon-iphone-retina.png">
<link rel="apple-touch-icon" sizes="152x152" href="http://enzolutions.com/assets/img/touch-icon-ipad-retina.png">


<link href="//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
<link href="http://enzolutions.com/assets/css/bootstrap.css" rel="stylesheet" media="screen">
<link href="http://enzolutions.com/assets/css/style.css" rel="stylesheet" media="screen">
<link href="http://enzolutions.com/assets/css/theme.css" rel="stylesheet" media="screen">

<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/default.min.css">
    </head>
    <body>
        <div id="wrap">
            <div class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <div class="navbar-brand">
            <a class="label label-primary" href="/">[enzo]lutions</a>
        </div>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
        <li><a href="/">
        About</a>
    </li>
        <li><a href="/blog">
        Blog</a>
    </li>
        <li><a href="/company">
        Company</a>
    </li>
        <li><a href="/projects">
        Projects</a>
    </li>
        <li><a href="/talks">
        Talks</a>
    </li>
    </ul>
        <div class="navbar-social text-right">
          <ul class="list-inline">
        <li>
        <a target="_blank" href="https://twitter.com/enzolutions">
            <i class="fa fa-twitter fa-2x"></i>
        </a>
    </li>
    
        <li>
        <a target="_blank" href="https://www.facebook.com/enzolutions">
            <i class="fa fa-facebook-square fa-2x"></i>
        </a>
    </li>
    
        <li>
        <a target="_blank" href="cr.linkedin.com/in/edugarcia/">
            <i class="fa fa-linkedin-square fa-2x"></i>
        </a>
    </li>
    
    
        <li>
        <a target="_blank" href="https://github.com/enzolutions">
            <i class="fa fa-github fa-2x"></i>
        </a>
    </li>
    
    
    
        <li>
        <a target="_blank" href="mailto:enzo@enzolutions.com">
            <i class="fa fa-paper-plane fa-2x"></i>
        </a>
    </li>
    
        <li>
        <a target="_blank" href="http://enzolutions.com/rss.xml">
            <i class="fa fa-rss fa-2x"></i>
        </a>
    </li>
    </ul>
        </div>
      </div><!--/.nav-collapse -->
    </div>
</div>
            <div class="container">
                    <article class="project">
    <header>
        <h1>
            Waterbed Rooms
        </h1>
    </header>


    <p>Waterbed Rooms is a Drupal 7 Feature to create a website similar to http://airbnb.com with minimal features.</p>

<h2>Download</h2>

<pre><code>$ git clone git@github.com:enzolutions/drupal_waterbed_rooms.git
</code></pre>

<h2>Tweaks and Tricks included</h2>

<p>This Feature includes some pretty cool tweaks and tricks. You can read more about them on the waterbed_rooms.module file.</p>

<p>Some of my favorites include:</p>

<ul>
<li><p>Custom Image Formatter for Services (Uses an absolute path with an option to define an image style preset).</p></li>
<li><p>View query alter used to add an extra “Group By”.</p></li>
<li><p>Creates a custom Service Resource (node_waterbed) to return some extra information about the owner. Also it enables field_pictures to return absolute paths.</p></li>
</ul>

<h2>Drupal Dependencies</h2>

<ul>
<li><a target="_blank" href="drupal.org/project/features">Features</a>.</li>
<li><a target="_blank" href="drupal.org/project/date">Date</a>.</li>
<li><a target="_blank" href="drupal.org/project/commerce">Commerce</a>.</li>
<li><a target="_blank" href="https://drupal.org/project/entityreference">Entityreference</a>.</li>
<li><a target="_blank" href="https://drupal.org/project/rules">Rules</a>.</li>
<li><a target="_blank" href="https://drupal.org/project/geocoder">Geocoder</a>.</li>
<li><a target="_blank" href="https://drupal.org/project/geocoder_autocomplete">Geocoder_autocomplete</a>.</li>
<li><a target="_blank" href="https://drupal.org/project/geofield">Geofield</a>.</li>
<li><a target="_blank" href="https://drupal.org/project/services">Services</a>.</li>
<li><a target="_blank" href="https://drupal.org/project/services_views">Services_views</a></li>
<li><a target="_blank" href="https://drupal.org/project/views">Views</a></li>
<li><a target="_blank" href="drupal.org/project/rooms">Rooms</a></li>
<li><a target="_blank" href="https://drupal.org/sandbox/ziomizar/2086255">Rooms_node</a>. (Sandbox)</li>
<li><a target="_blank" href="https://drupal.org/project/cors">Cors</a></li>
</ul>

<h2>Installation.</h2>

<p>Before enabling the Feature Waterbed Rooms, I recommend installing the Rooms module, because it could get a little tricky. You can find instructions on how to do that at <a target="_blank" href="http://www.drupalrooms.com/docs"></a>http://www.drupalrooms.com/docs</a> (don't forget the libraries section).</p>

<p>Another requirement is applying the patch <a target="_blank"href="https://drupal.org/node/2274681#comment-8816065"></a>https://drupal.org/node/2274681#comment-8816065</a> to Sandbox module Rooms Node.</p>

<p>After you enable the Waterbed Rooms feature, you are required to edit the Content Type "Standard Doubles" (/admin/structure/types/manage/room-standard-doubles) and enable the contact type as a Room Node. (see image)</p>

<p><img src="https://raw.githubusercontent.com/enzolutions/drupal_waterbed_rooms/master/images/edit_room_availability.png" alt="Edit Content Type Standard Doubles" title="Edit Content Type Standard Doubles" /></p>

<p>After creating some Standard Doubles nodes, you need to update the room availability (i.e.: http://YOURDOMAIN/node/1/availability) (see image)</p>

<p><img src="https://raw.githubusercontent.com/enzolutions/drupal_waterbed_rooms/master/images/edit_room_node_content_type.png" alt="Editing Room Node Availablity" title="Editing Room Node Availablity" /></p>

<h3>Usage</h3>

<p>The goal of this project is to create a backend for a service similar to Airbnb, after completing the installation steps and creating some Room Nodes with availability you will be ready to consume the API and fetch room information.</p>

<h4>Getting all rooms available</h4>

<pre><code>http://YOURDOMAIN/api/views/waterbed.json
</code></pre>

<h4>Getting all rooms available in a range of dates.</h4>

<pre><code>http://YOURDOMAIN/api/views/waterbed.json?availabilty[min]=2014-5-20&amp;availabilty[max]=2014-5-28
</code></pre>

<h4>Getting all rooms available in a range of price</h4>

<pre><code>http://YOURDOMAIN/api/views/waterbed?price[min]=30&amp;price[max]=45
</code></pre>

<p>You can combine price and date filtering. In any case we will a get JSON response similar to next example.</p>

<pre><code>[
  {
    nid: "1",
    legend: "Walk to downtown san jose from here. ",
    images: "http://waterbed-backend.7sabores.com/sites/default/files/styles/waterbed__260x195_/public/Atardecer-San-Jose.jpg?itok=R0sIs042, http://waterbed-backend.7sabores.com/sites/default/files/styles/waterbed__260x195_/public/62349C455.jpg?itok=Y_uonL9Y",
    rooms_availability_index_price: "45",
    latitude: "9.896970600000",
    longitude: "-84.061670900000",
    type: "Standard Doubles",
    date: "2014-05-27"
  },
  {
    nid: "2",
    legend: "Apartment in San José North Sabana",
    images: "http://waterbed-backend.7sabores.com/sites/default/files/styles/waterbed__260x195_/public/SAb-nor.-Condo-Bruno-24.jpg?itok=GuIkH3-v, http://waterbed-backend.7sabores.com/sites/default/files/styles/waterbed__260x195_/public/San-Jose-Real-Estate-Prices-Around-Parque-La-%20Sabana-Expected-To-Rise-Dramatically.jpg?itok=RD7Ip73F",
    rooms_availability_index_price: "60",
    latitude: "9.935231600000",
    longitude: "-84.102606200000",
    type: "Standard Doubles",
    date: "2014-05-27"
  }
]
</code></pre>

<p>You can check out a live demo at <a target="_blank"href="http://waterbed-backend.7sabores.com/api/views/waterbed.json">http://waterbed-backend.7sabores.com/api/views/waterbed.json</a>.</p>

<h4>CORS</h4>

<p>If you’re planning to use your own server to test, remember use the CORS module to enable CORS requests and avoid errors related to invalid client requests because the client isn't located under same domain.Just go to http://YOURDOMAIN/admin/config/services/cors and do a similar setting as suggested below.</p>

<pre><code>api/*|http://localhost:8080|POST,ADD,GET,PUT,DELETE,OPTIONS|X-CSRF-Token|true
</code></pre>

<p>Your port is necessary only if you use other port than 80</p>


    <footer>
      <div class="col-md-12">
         <ul class="list-unstyled">
                <li>
              <i class="fa fa-tags"></i>
              Drupal, JSON, REST, PHP, CORS
          </li>
                      <li>
              <i class="fa fa-folder"></i>
              projects
          </li>
        </ul>
      </div>
    </footer>


          <section>
  <h3>Comments</h3>
  <div id="disqus_thread"></div>
  <noscript>
      Please enable JavaScript to view the
      <a target="_blank" href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  <a target="_blank" href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>
    </article>
            </div>
        </div>

        <footer id="footer">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <ul class="list-inline">
        <li><a href="https://github.com/yosymfony/Spress-theme-spresso">
        Go to Spresso theme web</a>
    </li>
    </ul>
                    </div>
                    <div class="col-md-6 text-right">
                        <ul class="list-inline">
        <li>
        <a target="_blank" href="https://twitter.com/enzolutions">
            <i class="fa fa-twitter fa-2x"></i>
        </a>
    </li>
    
        <li>
        <a target="_blank" href="https://www.facebook.com/enzolutions">
            <i class="fa fa-facebook-square fa-2x"></i>
        </a>
    </li>
    
        <li>
        <a target="_blank" href="cr.linkedin.com/in/edugarcia/">
            <i class="fa fa-linkedin-square fa-2x"></i>
        </a>
    </li>
    
    
        <li>
        <a target="_blank" href="https://github.com/enzolutions">
            <i class="fa fa-github fa-2x"></i>
        </a>
    </li>
    
    
    
        <li>
        <a target="_blank" href="mailto:enzo@enzolutions.com">
            <i class="fa fa-paper-plane fa-2x"></i>
        </a>
    </li>
    
        <li>
        <a target="_blank" href="http://enzolutions.com/rss.xml">
            <i class="fa fa-rss fa-2x"></i>
        </a>
    </li>
    </ul>
                    </div>
                </div>
                <p class="text-center">
                    <a href="https://github.com/yosymfony/Spress-theme-spresso" title="Spresso theme">
                        <img src="http://enzolutions.com/assets/img/spresso-logo.png"/>
                    </a>
                </p>
                <p class="text-center">
                    &copy; 2014 enzo - Eduardo Garcia.
                    Powered by <a href="https://github.com/yosymfony/Spress">Spress</a>.
                </p>
            </div>
            <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
            <script src="/assets/js/bootstrap.min.js"></script>

            <script src="http://enzolutions.com/assets/js/github-repositories.js" type="text/javascript"></script>
            <script type="text/javascript">
              jQuery( document ).ready(function() {
                  jQuery("#my-github-projects").loadRepositories("enzolutions");
              });
            </script>

                        <script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
            <script>hljs.initHighlightingOnLoad();</script>
            
                        <script type="text/javascript">
            var disqus_shortname = 'enzolutions';

            (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
            </footer>
    </body>
</html>
